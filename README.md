# go-escape-analysis
escape analysis in golang



## Stack:
Stack is a block of memory allotted to each function. Memory is calculated on compile time.

## Heap:
Heap is a block of memory allotted demanded by your software at runtime.
Before goes into deep some terms must know

## Escape Analysis:

Gc compiler does global escape analysis across function and package boundaries. It checks a memory that it really needs to be allocated at a heap or it could be managed within a stack itself.

## Function Inlining:
Only short and simple functions are inlined. Function inlining is nothing but the whole code replaces the function call.

## Command For Escape Analysis:
```
go build -gcflags="-m"

```


## 1. Stack analysis 

````
package main

import (
	"fmt"
)

func init(){}

func main() {
	fmt.Println("main function")
	smallAllocation()
}
type smallStruct struct {
	a, b int64
	c, d float64
 }
 
 //go:noinline
 func smallAllocation() *smallStruct {
	return &smallStruct{}
 }

````

``
 $ go build -gcflags="-m"
 ``
 ```
 ./main.go:7:6: can inline init.0
./main.go:10:13: inlining call to fmt.Println
./main.go:20:9: &smallStruct literal escapes to heap
./main.go:10:14: "main function" escapes to heap
./main.go:10:13: []interface {} literal does not escape
<autogenerated>:1: .this does not escape
 ```

The meaning of escapes to the heap is variables needs to be shared across the function stack frames
